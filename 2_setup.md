<div style="page-break-before:always;">
</div>

# <a name="setup_natch"></a>2. Установка и настройка Natch

## <a name="complect"></a>2.1. Комплект поставки Natch

Инструмент *Natch* состоит из двух частей: непосредственно *Natch*, с помощью которого осуществляется сбор информации о работе ОО, и графическая подсистема
*SNatch*, в которой происходит обработка собранных данных и построение аналитик.

В комплект поставки инструмента входит пакет *Natch*, архив *SNatch* и документация.

Инструмент *Natch* распространяется в виде пакета для следующих операционных систем:

* Ubuntu 20
* Ubuntu 22
* Debian 11
* Alt 10
* Astra 1.7.3

В пакете представлен защищенный бинарный дистрибутив, требующий наличия аппаратного ключа (персональный "черный" ключ, сетевой "красный" ключ или иные версии ключа) с лицензией c идентификатором "6".

[Дистрибутив Natch v.2.4](https://nextcloud.ispras.ru/index.php/s/zxMra4pdpBRkCgd)

[Предыдущие релизы](9_appendix.md#app_releases)


## 2.2. Установка инструмента Natch

Установка *Natch* делится на два этапа:

* установка пакета в соответствии с хостовой ОС
* установка зависимостей

### 2.2.1. Установка пакета Natch

**Установка для Ubuntu и Debian**

Для установки *Natch* скачайте соответствующий вашей ОС дистрибутив и используйте команду (пример для ubuntu20):

```bash
sudo dpkg -i natch_2.4_ubuntu20.deb
```
Для удаления *Natch* из системы используйте команду:

```bash
sudo dpkg -r natch
```

**Установка для Alt**

Для установки *Natch* скачайте дистрибутив и используйте команду:
```
sudo rpm -ivh natch_2.4_alt10.rpm
```
Для удаления *Natch* из системы используйте команду:
```
sudo rpm -e --allmatches --nodeps natch
```

___

При установке *Natch* бинарные файлы распаковываются в ``/usr/bin/natch/``.

### 2.2.2. Установка зависимостей (кроме Alt)

После успешной установки *Natch* следует установить зависимости, необходимые для работы скриптов. Для этого нужно запустить скрипт `setup_requirements.sh`, находящийся в
папке установки инструмента:

```bash
/usr/bin/natch/bin/natch_scripts/setup_requirements.sh
```
Во время выполнения скрипта потребуется пароль администратора.

Для хостовой системы Alt установка зависимостей таким способом не требуется. Если на машине не установлен pip, то перед установкой пакета следует выполнить команду:
```bash
sudo apt-get install python3-module-pip
```

## <a name="setup_snatch"></a>2.3. Установка графической подсистемы SNatch

Для работы *SNatch* необходимо подготовить окружение, а именно установить ряд пакетов для хостовой ОС и Python, а также создать базу данных. Это делается автоматически с помощью скрипта `snatch_setup.sh`. Для установки потребуется пароль для sudo. Важно! Запускать скрипт под sudo не нужно, дождитесь запроса пароля. Пакеты для Python устанавливаются в виртуальную среду, таким образом пакеты на вашей машине не будут переустанавливаться и конфликтовать. Запускать скрипт нужно только при первом использовании, его повторный запуск приведет к удалению базы данных.

Установка *SNatch* включает в себя:
1. Распаковка архива snatch.zip
2. Запуск скрипта `snatch_setup.sh`

____
**Важно!**

В связи с переходом на новую версию аппаратных ключей инструмента лицензирования Sentinel до окончания действия всех выданных лицензий будут поддерживаться два варианта дистрибутива. Если у вас старые ключи Sentinel, то следует брать дистрибутив из папки Sentinel, если вы новый пользователь *Natch* - дистрибутив для вас в папке Sentinel_new. Так же рекомендуется переустановить окружение (aksusbd_*current_version*\_amd64.deb для Ubuntu/Debian, haspd-_*current_version*\_.x86_64.rpm для Alt), пакет находится в папке с дистрибутивом.
