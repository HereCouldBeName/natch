<div style="page-break-before:always;">
</div>

# <a name="snatch"></a>6. Анализ поверхности атаки с помощью SNatch

*SNatch* – это инструмент с графическим интерфейсом, предназначенный для постобработки и отображения данных, полученных от инструмента *Natch*. Работать с этим интерфейсом можно через браузер.

## 6.1. Системные требования

Тестирование инструмента проводилось на ОС Ubuntu 20.04 и Ubuntu 22.04. В качестве браузеров использовались Google Chrome версии 105.0.5148.2 и выше и Mozilla Firefox версии 101.0 и выше.

Необходимые для функционирования *SNatch* пакеты будут автоматически установлены в ходе первоначальной настройки.

## 6.2. Настройка и запуск

Для работы графического интерфейса *SNatch* необходимо подготовить окружение, а именно установить ряд пакетов для Ubuntu и Python, а также создать базу данных. Все это делается автоматически с помощью скрипта *snatch_setup.sh*. Для установки потребуется пароль для sudo. **Важно! Запускать скрипт под sudo не нужно, дождитесь запроса пароля.** Пакеты для Python устанавливаются в виртуальную среду, таким образом пакеты на вашей машине не будут переустанавливаться и конфликтовать. Запускать скрипт нужно только при первом использовании, его повторный запуск приведет к удалению базы данных.

Помимо скрипта для настройки окружения в пакет поставки входят скрипты *snatch_start.sh* и *snatch_stop.sh* для запуска и остановки *SNatch* соответственно. Скрипт *snatch_start.sh* запускает необходимые для работы службы, а также открывает браузер с интерфейсом. В терминал, из которого был запущен скрипт, будут приходить сообщения от сервера, однако, он свободен для использования, поэтому по окончании работы из него же можно запустить скрипт *snatch_stop.sh* для остановки служб. Запускать *snatch_stop.sh* следует всегда, в противном случае процессы останутся висеть в памяти вашего компьютера до перезагрузки.

Все скрипты для *SNatch* можно запускать из любого расположения. Если по какой-то причине при запуске
*snatch_start.sh* страница в браузере не загрузилась, но при этом службы запустились, следует обновить страницу.

После выполнения скрипта *snatch_start.sh* в этом же терминале начнут выводиться информационные сообщения о работе *SNatch* и сообщения о возникающих ошибках. Полученные сообщения можно использовать для отслеживания внутреннего процесса работы *SNatch* и в качестве данных при формировании обращений об обнаруженных багах. Помимо этого ведется логирование работы в файл *snatch.log*, который расположен в папке *Snatch*.

## 6.3. Работа со *SNatch*

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_main_ui.png><figcaption>_Окно SNatch_</figcaption>

На данном рисунке показано окно *SNatch*, где цифрами обозначены основные элементы интерфейса:

1. Кнопка для вызова главного меню, из которого можно создать новый проект, запустить ряд функций, относящихся к открытому проекту, и открыть существующий проект.
2. Меню открытого проекта. Содержит список доступных данных для проекта (таких как: граф процессов, граф модулей, дерево процессов, граф вызовов и т.д.)
3. Кнопка для сворачивания меню проекта.
4. Кнопка для генерации дополнительных графов для проекта (граф вызовов, граф вызовов python и флейм граф).
5. Название открытого проекта. По нажатию на элемент активируется режим редактиврования, и имя проекта можно изменить.
6. Панель открытых вкладок с содержимым. Каждая вкладка содержит имя и кнопку закрытия. Также на панели представлена кнопка для быстрого закрытия всех вкладок.
7. Окно отображения содержимого.

### 6.3.1 Главное меню
Главное меню предоставляет доступ к созданию нового проекта, настройкам, экспорту открытого проекта в .pdf и информации о проекте. Также здесь отображается список существующих проектов, открытие которых осуществляется по нажатию на имя, а удаление – по нажатию на кнопку "del" рядом с именем.

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_menu.png><figcaption>_Главное меню_</figcaption>


#### 6.3.1.1. Создание проекта

Для создания нового проекта необходимо выбрать в главном меню пункт *New project...*.

При создании нового проекта открывается модальное окно:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_new_proj_modal.png><figcaption>_Создание проекта_</figcaption>

В данном окне пользователь должен ввести имя нового проекта в соответствующее поле *Project name*,
а также выбрать архив от *Natch* в поле *Choose an output.tar.zst*. Эти поля являются обязательными при создании проекта, поэтому только при их заполнении становится активна кнопка *Create*. Если в момент выбора файла архива поле имени не заполнено, то в него автоматически подставится имя файла. По нажатию на *Create* создаётся проект, запускается обработка архива, и окно закрывается. При нажатии на кнопку *Close* окно закрывается без создания проекта.

Помимо обязательных полей в данном окне присутствует опциональное поле *Description*, в котором можно оставить пользовательские заметки. При работе с проектом эту информацию можно будет увидеть в разделе *About the project*.

Название проекта не может содержать ряд специальных символов, и *Snatch* не даст их использовать как при первичном создании проекта, так и при переименовании.

При обработке архива можно параллельно запускать создание новых проектов, однако это может привести к общему замедлению работы.

Во время обработки архива поверхности атаки в верхней части экрана появляется шкала прогресса следующего вида:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_progressbar.png><figcaption>_Шкала прогресса_</figcaption>

В процессе обработки текст, сопровождающий шкалу прогресса, будет изменяться таким образом, чтобы оповещать об актуальном статусе выполняемой задачи. Нажатие на кнопку *Abort* прерывает процесс обработки. Проект при этом следует удалить самостоятельно.

При создании проекта (и открытии проекта без сохраненных вкладок) в нём по умолчанию открывается окно графа процессов.

#### 6.3.1.2. Настройки

Для открытия окна настроек необходимо вызвать из главного меню пункт *Settings*. Содержимое открытого окна будет иметь следующий вид:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_settings.png><figcaption>_Настройки_</figcaption>

В настоящий момент в настройках представлены только поля для конфигурации соединения со *[Svacer](https://www.ispras.ru/technologies/svace/)*, а именно: сетевой адрес, логин и пароль. Это же окно будет открыто при первой попытке взаимодействия со *Svacer* из графа процессов, если параметры соединения не были ранее заданы.

#### 6.3.1.3. Экспортирование проекта

Для экспортирования основной информации о текущем проекте необходимо вызвать из главного меню пункт *Export to pdf*. Содержимое открытого окна будет иметь следующий вид:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_export_modal.png><figcaption>_Окно экспорта_</figcaption>

В данном окне можно выбрать какие именно данные попадут в сгенерированный файл. Выбирать можно из: [графа процессов](#process_graph), [графа модулей](#module_graph), [дерева процессов](#process_tree) и [ресурсов](#resources). Для графа процессов и графа модулей включение в экспорт доступно только после первого открытия, так как требуется первоначальная конфигурация этих графов (в противном случае в окне будет отображаться информационное сообщение). Для дерева процессов и ресурсов можно с помощью переключателей настроить будет ли в сгенерированных данных отображаться информация о процессах запущенных с root-привилегиями, а так же полный объем информации, или только о взаимодействии с помеченными данными. После нажатия кнопки *Generate* будет запущен процесс генерация файла, по завершении которого пользователю будет предложено сохранить полученный файл.

Помимо выбранных пунктов в сгенерированный файл всегда попадает содержимое вкладки "About the project" и таблица соответствия внутренних идентификаторов процессов к имеющимся о них данным.

#### 6.3.1.4. О проекте

Для открытия информации о проекте необходимо вызвать из главного меню пункт *About the project*. Содержимое открытой вкладки будет иметь следующий вид:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_about_project.png><figcaption>_Данные о проекте_</figcaption>

Окно содержит следующие элементы:

1. Данные о загруженном архиве: дата создания, рабочая директория, диапазон шагов (процессорных инструкций) сценария, порог пометок, данные о рассматриваемых источниках пометок.
2. Статистика помеченных данных в рассматриваемом сценарии.
3. Версия *Natch*, на которой происходила запись архива.
4. Заметки для проекта. По умолчанию здесь размещается содержимое поля *Description*, если оно было использовано при создании проекта. Заметки можно редактировать, сохранение происходит автоматически.

### <a name="process_graph"></a>6.3.2. Граф процессов

Граф процессов открывается автоматически после создания проекта, при наличии в проекте помеченных данных (в противном случае будет выведено информационное сообщение). Его также можно открыть через меню проекта.
В меню графа процессов есть два пункта: *Process-graph* и *Process-graph content* (json представление графа). После выбора одного из этих пунктов открывается новая вкладка с соответствующим названием. Для *Process-graph content* содержимое вкладки будет представлено текстом, а для *Process-graph* откроется вкладка следующего вида:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_process_graph.png><figcaption>_Граф процессов_</figcaption>

В окне графа процессов представлены следующие элементы:

1. Шкала выбора активного шага выполнения. Перемещение по данной шкале соответствующим образом изменяет отображаемый граф.
2. Кнопки сохранения (экспорта в pdf) текущего состояния графа. По нажатию кнопки "Save" происходит создание цветного изображения графа, по нажатию на "BW" – черно-белого.
3. Выбор режима отображения графа. Граф процессов поддерживает 4 режима отображения:
   * *Active* – отображаются элементы (узлы и стрелки), которые задействованы на текущем шаге;
   * *Past* – отображаются элементы, которые задействованы на текущем шаге, а также те, которые произошли в прошлом (узлы и стрелки серого цвета);
   * *Significant* – отображаются элементы, которые задействованы на текущем шаге, а также те узлы, которые были задействованы в прошлом и при этом еще будут задействованы в будущем, и прошедшие стрелки между ними (узлы и стрелки бледных цветов);
   * *All* – отображаются элементы, которые задействованы на текущем шаге, а также те узлы (но не стрелки), которые вообще существуют на схеме (узлы бледных цветов).
4. Легенда графа. Описывает набор отображаемых на графе узлов и их внешний вид. По нажатию на элемент легенда скрывается и может быть повторно вызвана нажатием на оставшийся "язычок".
4. Граф процессов. Интерактивный граф, отображающий взаимодействие процессов, работавших с помеченными данными. Расположение узлов на графе можно изменять удобным для пользователя образом. При наличии информации о контейнерах, они будут отображены на графе в виде зеленых блоков, содержащих соответствующие им процессы. При нажатии на узел происходит отображение бокового информационного окна:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_process_infoblock.png><figcaption>_Информационное окно_</figcaption>

В информационном блоке содержатся: название выбранного элемента, его свойства, кнопка открытия соответствующего отфильтрованного графа модулей.

Отдельно обращаем внимание, что положение узлов при взаимодействии с графом сохраняется. При повторном открытии графа процессов узлы будут расположены так же, как и в прошлый раз, при этом не будет происходить перестроение графа с учетом физической модели.

При нажатии правой кнопкой мыши на узел в графе процессов появляется контекстное меню, из которого можно осуществить взаимодействие со *Svacer*. При первой попытке взаимодействия пользователю будет предложено установить адрес сервера, имя и пароль пользователя (если ранее это не было установлено через раздел *Settings*). Затем пользователь увидит окно следующего вида:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_svacer.png><figcaption>_Параметры открытия Svacer_</figcaption>

В данном окне можно выбрать проект *Svace*, ветку и снэпшот. После нажатия на кнопку *Open* будет открыто новое окно браузера со *Svacer*, сконфигурированным в соответствии с установленными параметрами.

### 6.3.3. <a name="module_graph"></a>Граф модулей

В меню графа процессов есть два пункта: *Module-graph* и *Module-graph content* (json представление графа). После выбора одного из этих пунктов открывается новая вкладка с соответствующим названием. Для *Module-graph content* содержимое вкладки будет представлено текстом, а для *Module-graph* откроется вкладка следующего вида:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_module_graph.png><figcaption>_Граф модулей_</figcaption>

Функционал этого окна почти полностью повторяет функционал графа процессов (см 6.3.2):

1. Шкала выбора активного шага выполнения. Перемещение по данной шкале соответствующим образом изменяет отображаемый граф.
2. Кнопки экспорта графа в цветном и черно-белом варианте.
3. Сворачиваемая легенда графа. Описывает набор отображаемых на графе узлов и их внешний вид.
3. Граф модулей. Интерактивный граф, отображающий взаимодействие модулей, работавших с помеченными данными. Расположение узлов на графе можно изменять удобным для пользователя образом. Стрелки, описывающие взаимодействие, сопровождаются номером, соответствующим очередности взаимодействия. Номер с символом "*" означает, что между узлами было более одного взаимодействия (очередность номера описывает только первый случай этого взаимодействия).

Так же, как и в графе процессов, нажатие на узел в графе модулей вызывает информационное окно, содержащее данные о выбранном элементе.
При взаимодействии с графом его положение сохраняется и воспроизводится при последующем открытии.

### 6.3.4. Графы вызовов
#### 6.3.4.1. Классический граф вызовов

В процессе первоначальной обработки архива поверхности атаки граф вызовов не создаётся. Чтобы граф вызовов появился в проекте, необходимо нажать на кнопку *Generate* рядом с соответствующим пунктом в меню проекта. Повторное нажатие кнопки до завершения генерации приведет к отмене процесса. По завершении генерации в боковом меню проекта под пунктом *Additional graphs* станет активным пункт *Call-graph* и появится пункт *Python-call-graph* (только при наличии в архиве файла python.log, описано в [граф вызовов python](#python_call_graph)). Для открытия графа вызовов достаточно нажать на данный пункт в меню. После открытия появится новая вкладка с соответствующим названием, а в окне отображения содержимого откроется граф, представленный в виде древовидной структуры:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_call_graph.png><figcaption>_Граф вызовов_</figcaption>

В данном окне представлены следующие элементы:

1. Чекбоксы опций. *Hide symbolless graphs* прячет из отображаемого графа деревья, не содержащие распознанных символов (если данная опция неактивна, то в текущем проекте все деревья содержат символьную информацию); *Full modules path* задаёт формат отображения имен модулей на графе: сокращенный или полный путь.
2. Элементы управления графом. Первая кнопка (три горизонтальные черты с буквой "А") раскрывает все ветви графа; кнопка с буквой "S" раскрывает только символизированные ветви. Повторное нажатие кнопки сворачивает граф. Нажатие на кнопки +/- рядом с веткой раскрывает/сворачивает данную ветку в дереве.
3. Содержимое графа. В корне дерева отображается имя процесса, к которому относится данный граф вызовов. Каждый узел дерева содержит имя вызванной функции (адрес смещения в модуле, при отсутствии символьной информации), путь к файлу исходного кода и строка в файле, относящаяся к началу функции, имя модуля. Синим цветом выделяются функции непосредственно взаимодействовавшие с помеченными данными. При наведении курсора на "синие" функции возникает всплывающая подсказка, содержащая номера строк в исходниках, где происходило взаимодействие с помеченными данным. Бежевым цветом выделяются функции python, вызванные на этом шаге.

При нажатии на функцию правой кнопкой мыши появляется контекстное меню, из которого можно запустить генерацию вспомогательных данных для [Futag](https://github.com/ispras/Futag), скопировать имя функции и перейти к соответствующей записи в графе вызовов python для "бежевых" функций. Сгенерированные данные для [Futag](https://github.com/ispras/Futag) будут помещены в файл в папке *snatch_directory/fuzzing_targets*.

При нажатии на функцию левой кнопкой мыши происходит отображение информационного окна:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_callgraph_infoblock.png><figcaption>_Информация о функции_</figcaption>

В данном окне содержатся: имя функции, её опции, стек вызовов вплоть до выбранной функции. Синим на стеке вызовов отображаются функции, взаимодействовавшие с помеченными данными.

#### <a name="python_call_graph"></a>6.3.4.2 Граф вызовов python

При построении графа вызовов строится и граф вызовов python, если в архиве содержалась соответствующая информация. Визуально и функционально данный граф повторяет классический граф вызовов:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_python_call_graph.png><figcaption>_Граф вызовов python_</figcaption>

Из контекстного меню функций, вызываемого правой кнопкой мыши, можно переайти в классический граф вызовов, где будет выбран соответствующий элемент.

### 6.3.5. Флейм граф

Как и *Call-graph* при создании проекта флейм граф не генерируется. Для генерации необходимо нажать на кнопку *Generate* и по завершении вызвать флейм граф нажатием на пункт в меню проекта. Обращаем внимание, генерация флейм графа – ощутимо медленный процесс, поэтому если вам кажется, что генерация зависла, то с большой вероятностью это не так: просто требуется еще подождать. Во флейм графе отображаются функции в соответствии с порядком их вызова (снизу-вверх), размер же зависит от продолжительности выполнения функции. Выглядит окно флейм графа следующим образом:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_flame_graph.png><figcaption>_Флейм граф_</figcaption>

В данном окне представлены следующие элементы:

1. Выпадающий список построенных флейм графов, сгруппированный по процессам. Графы, относящиеся к пользовательским потокам, помечены словом *user*, выполнявшиеся ядром – *kernel*. При нажатии на пункт списка произойдет открытие соответствующего флейм графа.
2. Список цветовых схем графа. По умолчанию выбирается схема "warm" с оттенками теплого цвета для обычных функций. Во всех цветовых схемах яркий синий цвет обозначает функции, взаимодействовавшие с помеченными данными.
3. Кнопки навигации по флейм графу. Используются для перемещения между функциями, работавшими с помеченными данными. Нажатие на кнопку *вниз* делает активным следующую такую функцию, *вверх* – предыдущую, а *Reset zoom* сбрасывает граф к исходному состоянию (активным становится корневой блок)
4. Список функций, работавших с помеченными данными. В данном списке показано имя функции (либо смещение относительно адреса загрузки модуля, в отсутствии символьной информации) и продолжительность работы функции (синим цветом) в выполненных процессорных инструкциях. При нажатии на пункт в этом списке, соответствующая функция на флейм графе становится активной и для нее вызывается информационное окно.
5. Флейм граф. В верхней части показано имя открытого флейм графа. Синим цветом на флейм графе отображаются функции, взаимодействовавшие с помеченными данными. При нажатии на любой блок флейм графа он становится активным, т.е. занимает 100% ширины графа, с соответствующим расширением дочерних блоков. Также для выделенной функции будет отображено информационное окно со свойствами этой функции (по аналогии с информационным окнами описаными выше для графа вызовов, графа процессов и т.д.)

### 6.3.6. Временной граф процессов

Для открытия временного графа процессов необходимо вызвать из меню проекта пункт *Process-timeline*. Содержимое открытой вкладки будет иметь следующий вид:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_process_timeline.png><figcaption>_Временной граф процессов_</figcaption>

Временной граф процессов представляет собой граф, где горизонтальная ось отображает время выполнения процесса, от его начала и до завершения. Синим цветом на графе показаны процессы, в которых происходило взаимодействие с помеченными данными, бледно-розовым - процессы с root-привилегиями, ярко-розовым - процессы с root-привилегиями, взаимодействовавшие с помеченными данными. Зеленым фоном отмечены границы контейнеров.

В данном окне представлены следующие элементы:

1. Набор фильтров отображаемой информации. При установленной галочке *Kernel* на графе будут отображаться процессы уровня ядра; при галочке *Container* будут отображаться служебные процессы функционирования контейнеров (на данный момент docker).
2. Боковая панель. При нажатии на процесс появляется боковая панель со следующей информацией о процессе (не для всех процессов доступен полный набор информации): имя процесса, pid, uid, путь к исполняемому файлу, исполняемая команда, родительские процессы.
3. Кнопка открытия вкладки с графом процессов на моменте, когда выбранный процесс появился на графе первый раз.
4. Всплывающее меню с краткой информацией о процессе (появляется при наведении). Включает в себя путь к бинарному файлу и строку запуска при наличии.

По умолчанию граф полностью вмещается по ширине в отображаемое окно, однако можно увеличить масштаб графа с помощью комбинации *Ctrl+Scroll*. В таком случае движение по горизонтальной оси для просмотра графа осуществляется с помощью перетаскивания графа с зажатой левой кнопкой мыши. Движение по вертикальной оси при этом осуществляется с помощью *Scroll* мышью.

### <a name="process_tree"></a>6.3.7. Дерево процессов

Для открытия дерева процессов необходимо вызвать из меню проекта пункт *Process-tree*. Содержимое открытой вкладки будет иметь следующий вид:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_process_tree.png><figcaption>_Дерево процессов_</figcaption>

На дереве процессов показано отношение между процессами в формате "родитель-потомок", при этом процессы непосредственно взаимодействовавшие с помеченными данными, выделены синим цветом. Ярко-розовым цветом выделены процессы, запущенные с root-привилегиями и работавшие с помеченными данными, а бледно-розовым - просто запущенные с root-привилегиями. Помимо имени процесса на графе также отображаются его идентификаторы pid и uid, и команда, которой он был запущен (если удалось её определить).

Для дерева доступен фильтр *Tainted only*, который оставляет в дереве только те процессы, которые работали с помеченными данными, или являлись родителями процессов, работавших с помеченными данными.

### <a name="resources"></a>6.3.8. Список ресурсов

Для открытия списка ресурсов проекта необходимо вызвать из меню проекта пункт *Resources*. Содержимое открытой вкладки будет иметь следующий вид:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_resources.png><figcaption>_Список ресурсов_</figcaption>

Ресурсы описываются древовидной структурой, где в корне располагается название процесса. Цветовая индикация процессов означают следующее: бледно-розовые - процессы с root-привилегиями; ярко-розовые - процессы с root-привилегиями, взаимодействовавшие с помеченными данными; синие - пользовательские процессы, взаимодействовавшие с помеченными данными. Для каждого процесса при наличии будут отображены: используемые им модули (синим обозначены работавшие с помеченными данными) с полным именем и базовым адресом загрузки; использованные сокеты; использованные файлы; использованные скрипты.

Для списка ресурсов доступен фильтр *Tainted only*, который оставляет в списке только те процессы, которые работали с помеченными данными.

### 6.3.9. Список файлов

Для открытия списка файлов проекта необходимо вызвать из меню проекта пункт *Files*. Содержимое открытой вкладки будет иметь следующий вид:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_files.png><figcaption>_Список файлов_</figcaption>

В списке представлены файлы, с которыми была работа в сценарии. Голубым цветом отмечены файлы, в которые попали помеченные данные. Для каждого файла можно развернуть список процессов, которые взаимодейстовали с файлом (открывали/читали/писали/запускали его). Если файл открывал процесс ядра, то в список этот файл не попадет. В список процессов процессы ядра также не попадают. Цветовая индикация процессов аналогична используемой в списке ресурсов. В боковом меню отображается информация о выбранном процессе.

Для списка доступны фильтры по имени директории, в которой расположен файл. Если фильтр недоступен, значит нет ни одного файла, подпадающего под него.

### 6.3.10. Сетевой трафик

Доступ к информации о сетевом трафике будет предоставлен только при сборе соответствующих данных во время работы *Natch* (это делается по умолчанию, а в архив помещается \*.pcap файл). Для интерактивной работы с предоставленными данными необходимо иметь установленный в системе *wireshark*.
Для открытия данных о сетевом трафике проекта необходимо вызвать из меню проекта пункт *Traffic*. Содержимое открытой вкладки будет иметь следующий вид:

<img src=https://raw.githubusercontent.com/ispras/natch/main/images/snatch/snatch_traffic.png><figcaption>_Сетевой трафик_</figcaption>

Окно содержит следующие элементы:

1. Кнопка открытия в *wireshark* pcap файла с сетевыми пакетами (только входящими), которые были помечены в анализируемом сценарии. Открытие *wireshark* с нужным файлом произойдет автоматически.
2. Кнопка открытия в *wireshark* pcap файла с сетевыми пакетами (входящими и исходящими), которые появлялись в анализируемом сценарии.
3. Кнопка открытия в *wireshark* pcap файла с сетевыми пакетами (входящими и исходящими), которые появлялись в системе, начиная со старта.
4. Список MAC-адресов, участвоваших в работе анализируемого сценария. По нажатию на элемент списка произойдет открытие *wireshark* с примененным фильтром для выбранного устройства.
5. Список сетевых сессий (взаимодействий между двумя сетевыми адресами), участвоваших в работе анализируемого сценария. Нажатие на элемент списка запустит *wireshark* с фильтром на взаимодействие между указанными адресами. Зеленый блок в заголовке описывает количество элементов в списке.

## 6.4. Список горячих клавиш

### 6.4.1. Общие комбинации

- *Ctrl+Alt+N* – вызывает модальное окно создания нового проекта
- *Ctrl+Alt+G* – запускает одновременную генерацию флейм графа и графа вызовов
- *Ctrl+Alt+C* – открывает граф вызовов (при наличии)
- *Ctrl+Alt+F* – открывает флейм граф (при наличии)
- *Ctrl+Alt+P* – открывает граф процессов
- *Ctrl+Alt+M* – открывает граф модулей
- *Ctrl+Alt+L* – открывает временной граф процессов
- *Ctrl+Alt+R* – открывает дерево процессов
- *Ctrl+Alt+E* – открывает список ресурсов
- *Ctrl+Alt+A* – открывает список файлов
- *Ctrl+Alt+I* – открывает сетевой трафик
- *Ctrl+X* – закрывает текущую вкладку в окне *SNatch*. Также вкладку можно закрыть по нажатию колесиком мыши.
- *Ctrl+Shift+X* – закрывает все открытые вкладки в окне *SNatch*
- *Shift+Tab* – выбирает следующую открытую вкладку в окне *SNatch*

### 6.4.2. Управление интерактивными элементами вкладок

Флейм граф:

- *↓* – переход к следующей помеченной функции
- *↑* – переход к предыдущей помеченной функции
- *Ctrl+↓* – сброс состояния flame графа

Граф процессов:

- *→* – переход к следующему шагу
- *←* – переход к предыдущему шагу
- *Ctrl+→* – переход к последнему шагу
- *Ctrl+←* – переход к первому шагу
- *Ctrl+↓* – выбор предыдущего режима отображения
- *Ctrl+↑* – выбор следующего режима отображения

Граф модулей:

- *→* – переход к следующему шагу
- *←* – переход к предыдущему шагу
- *Ctrl+→* – переход к последнему шагу
- *Ctrl+←* – переход к первому шагу

## 6.5. Отладочная информация

При возникновении ошибок следует обратиться к отладочной информации и передать её разработчикам с описанием сценария возникновения ошибки. Отладочная информация выводится в файл *snatch.log* в корне *Snatch*.
